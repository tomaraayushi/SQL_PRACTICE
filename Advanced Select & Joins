--Q1
with managers as(
    select
        reports_to as employee_id,
        count(reports_to) as reports_count,
        round(avg(age)) as average_age
    from employees
    where reports_to is not null
    group by reports_to
)

select
    m.employee_id,
    e.name,
    m.reports_count,
    m.average_age
from employees e
inner join managers m
    on e.employee_id = m.employee_id
order by e.employee_id;
